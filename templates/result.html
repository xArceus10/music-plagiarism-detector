<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plagiarism Analysis Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f0f2f5; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        /* --- CHANGED: Increased max-width from 1000px to 1200px --- */
        .container { max-width: 1200px; margin-top: 40px; }
        .card { border: none; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        .header-section { background-color: #2c3e50; color: white; padding: 20px; border-radius: 12px 12px 0 0; }

        /* Highlight Box Styles */
        .highlight-box {
            background: linear-gradient(135deg, #fff3cd 0%, #ffecb5 100%);
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
        }
        .highlight-title { color: #856404; font-weight: bold; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; }
        .highlight-song { font-size: 1.4rem; font-weight: 700; color: #333; margin: 5px 0; }
        .highlight-score { font-size: 1.2rem; font-weight: bold; }
        .score-high { color: #dc3545; }
        .score-med { color: #fd7e14; }
        .score-low { color: #28a745; }

        /* Table Styles */
        .table-custom th { font-size: 0.85rem; text-transform: uppercase; color: #6c757d; font-weight: 600; }
        .table-custom td { vertical-align: middle; }
        .badge-score { font-size: 0.9rem; padding: 6px 12px; }
    </style>
</head>
<body>

<div class="container mb-5">
    <div class="card">
        <div class="header-section text-center">
            <h3>üìä Analysis Report</h3>
            <p class="mb-0 opacity-75">File: {{ filename }}</p>
        </div>

        <div class="card-body p-4">

            <div class="row mb-2">
                <div class="col-md-6">
                    <div class="highlight-box">
                        <div class="highlight-title">üéµ Top Audio Match</div>
                        {% if audio_results and audio_results|length > 0 %}
                            <div class="highlight-song">{{ audio_results[0].song }}</div>
                            <div class="highlight-score score-{{ 'high' if audio_results[0].score > 70 else 'med' }}">
                                Match: {{ audio_results[0].score }}%
                            </div>
                        {% else %}
                            <div class="text-muted mt-2">No significant match found.</div>
                        {% endif %}
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="highlight-box" style="background: linear-gradient(135deg, #d1ecf1 0%, #c3e6cb 100%); border-left-color: #28a745;">
                        <div class="highlight-title" style="color: #155724;">üìù Top Lyrical Match</div>
                        {% if lyrics_results and lyrics_results|length > 0 %}
                            <div class="highlight-song">{{ lyrics_results[0].song }}</div>
                            <div class="highlight-score score-{{ 'high' if lyrics_results[0].score > 70 else 'med' }}">
                                Similarity: {{ lyrics_results[0].score }}%
                            </div>
                        {% else %}
                            <div class="text-muted mt-2">No significant match found.</div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <h5 class="mb-3 text-secondary">üéß Audio Fingerprint Matches (Top 3)</h5>
                    <table class="table table-hover table-custom">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Song Name</th>
                                <th class="text-end">Match %</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for result in audio_results %}
                            <tr class="{{ 'table-warning' if loop.index == 1 }}">
                                <td>#{{ loop.index }}</td>
                                <td>{{ result.song }}</td>
                                <td class="text-end">
                                    <span class="badge {{ 'bg-success' if result.score > 70 else 'bg-warning text-dark' if result.score > 40 else 'bg-danger' }} badge-score">
                                        {{ result.score }}%
                                    </span>
                                </td>
                            </tr>
                            {% else %}
                            <tr><td colspan="3" class="text-center text-muted">No matches found</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <div class="col-md-6">
                    <h5 class="mb-3 text-secondary">üìú Lyrical Similarity Matches (Top 3)</h5>
                    <table class="table table-hover table-custom">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Song Name</th>
                                <th class="text-end">Similarity</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for result in lyrics_results %}
                            <tr class="{{ 'table-success' if loop.index == 1 }}">
                                <td>#{{ loop.index }}</td>
                                <td>{{ result.song }}</td>
                                <td class="text-end">
                                    <span class="badge {{ 'bg-success' if result.score > 70 else 'bg-warning text-dark' if result.score > 40 else 'bg-danger' }} badge-score">
                                        {{ result.score }}%
                                    </span>
                                </td>
                            </tr>
                            {% else %}
                            <tr><td colspan="3" class="text-center text-muted">No matches found</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="text-center mt-4">
                <a href="/" class="btn btn-primary btn-lg px-5">Check Another File</a>
            </div>

        </div>
    </div>
</div>

</body>
</html>